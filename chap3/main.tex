%%%%%%%%%%%%%%%% Springer %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% RECOMMENDED %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[graybox]{svmult}
% choose options for [] as required from the list
% in the Reference Guide
\usepackage{type1cm}        % activate if the above 3 fonts are
                            % not available on your system
%
\usepackage{makeidx}         % allows index generation
%\usepackage{graphicx}        % standard LaTeX graphics tool
                             % when including Fig.~files
\usepackage{multicol}        % used for the two-column index
\usepackage[bottom]{footmisc}% places footnotes at page bottom
\usepackage{newtxtext}       % 
\usepackage{newtxmath}       % selects Times Roman as basic font
% see the list of further useful packages
% in the Reference Guide
%\makeindex             % used for the subject index
                       % please use the style svind.ist with
                       % your makeindex program
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \usepackage{amsmath}
% \usepackage{ascmac}
\usepackage[dvipdfmx]{graphicx}  % for EPS and PDF 
% \usepackage{url}
\usepackage{fancyvrb}
% \usepackage{makeidx}
% \usepackage{float}
% \usepackage[dvipdfmx]{color}
% \usepackage{ulem}
% \usepackage[switch*,pagewise]{lineno}
% \usepackage[dvipdfm,bookmarkstype=toc,urlcolor=black,%
%     linkcolor=black,citecolor=black,bookmarks=false]{hyperref}
% \usepackage{fancyhdr}

\usepackage{listings}
\lstset{%
 language={C},
% basicstyle={\scriptsize},%
% identifierstyle={\scriptsize},%
 basicstyle={\small},%
 identifierstyle={\small},%
% commentstyle={\small\itshape},%
%commentstyle={\scriptsize},%
commentstyle={\small},%
 keywordstyle={\small\bfseries},%
 ndkeywordstyle={\small},%
stringstyle={\small\ttfamily},
 frame={tb},
 breaklines=true,
 columns=[l]{fullflexible},%
 numbers=left,%
 xrightmargin=1zw,%
 xleftmargin=1.5zw,%
 numberstyle={\small},%
 stepnumber=1,
 numbersep=1zw,%
% lineskip=-0.1ex%
}

\def\|{\verb|}

%\newenvironment{myfigure}{\begin{figure}[ht]\begin{center}}{\end{center}\end{figure}}

\def\Directive#1{{\tt #1}\index{#1@{\tt #1}}\index{Directive!#1@{\tt #1}}}

%\def\Syntax#1{\index{{\tt #1}}\index{Syntax!{\tt #1}}}
\def\Syntax#1{\index{Syntax!#1@{\tt #1}}}

\def\Term#1{{#1}\index{#1}}

%\def\Example#1{\index{#1}\index{Example!{\tt #1}}}
\def\Example#1{\index{Example!#1@{\tt #1}}}

\def\Intrinsic#1{\index{#1@{\tt #1}}\index{Intrinsic and Library Procedures!#1@{\tt #1}}}

\DefineVerbatimEnvironment{Fexample}{Verbatim}{numbers=left,numbersep=3pt,stepnumber=5,%
frame=single,label=\Fort}
\DefineVerbatimEnvironment{FexampleR}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,%
frame=single,label=\Fort}

\DefineVerbatimEnvironment{Cexample}{Verbatim}{numbers=left,numbersep=3pt,stepnumber=5,%
frame=single,label=\C}
\DefineVerbatimEnvironment{CexampleR}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,%
frame=single,label=\C}

\DefineVerbatimEnvironment{XFexample}{Verbatim}{numbers=left,numbersep=3pt,stepnumber=5,%
frame=single,label=\XMPF}
\DefineVerbatimEnvironment{XFexampleR}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,%
frame=single,label=\XMPF}

\DefineVerbatimEnvironment{XCexample}{Verbatim}{numbers=left,numbersep=3pt,stepnumber=5,%
frame=single,label=\XMPC}
\DefineVerbatimEnvironment{XCexampleR}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,%
frame=single,label=\XMPC}

\DefineVerbatimEnvironment{MPICexample}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,%
frame=single,label=MPI C}
\DefineVerbatimEnvironment{MPIFexample}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,%
frame=single,label=MPI Fortran}


\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{3}
\setcounter{totalnumber}{6}
\usepackage{fancyhdr}

\let\olditemize\itemize
\renewcommand{\itemize}{
   \olditemize
   \setlength{\itemsep}{8pt}
   \setlength{\parskip}{0pt}
   \setlength{\parsep}{0pt}
}

% \parindent = 0pt
% \hoffset=0cm
% \oddsidemargin=0cm
% \evensidemargin=0cm
% \textwidth=16cm
% \topmargin=-1cm
% \voffset=0cm
% \textheight=24cm

\def\progenv{\baselineskip=10pt\tt\progspecial{`}\parindent=0.3cm}
\def\shellenv{\baselineskip=10pt\tt\progspecial{`}\parindent=0.3cm\nolineno}

\renewcommand{\topfraction}{.99}
\renewcommand{\bottomfraction}{.99}

\def\openb{{\it [}}
\def\closeb{{\it ]}}
\def\XMP{XcalableMP}
\def\XACC{XcalableACC}
\def\OACC{OpenACC}
\def\OMP{OpenMP}
\def\XMPF{XcalableMP Fortran}
\def\XMPC{XcalableMP C}
\def\XACCF{XcalableACC Fortran}
\def\XACCC{XcalableACC C}
\def\Syntax#1{\index{Syntax!#1@{\tt #1}}}
\def\Example#1{\index{Example!#1@{\tt #1}}}
%
\def\phrule{\vspace{0.2cm}\hrule\vspace{0.05cm}\hrule}
\def\qhrule{\vspace{0.2cm}\hrule}
\def\dhrule{\hrule\vspace{0.05cm}\hrule}
\def\bsquare{\rule[-2pt]{5pt}{10pt}}
%
\newenvironment{mytable}[3]{\begin{table}[ht]\caption{#1}\label{#2}\vspace*{-0.3cm}\begin{center}\begin{tabular}{#3}}{\end{tabular}\end{center}\end{table}}
\newenvironment{myfigure}{\begin{figure}[ht]\begin{center}}{\end{center}\end{figure}}
%
\DefineVerbatimEnvironment{XACCFexampleL}{Verbatim}{numbers=left,numbersep=3pt,stepnumber=5,frame=single,label=\XACCF}
\DefineVerbatimEnvironment{XACCCexampleR}{Verbatim}{numbers=right,numbersep=3pt,stepnumber=5,frame=single,label=\XACCC}
\DefineVerbatimEnvironment{XACCCexampleL}{Verbatim}{numbers=left,numbersep=3pt,stepnumber=5,frame=single,label=\XACCC}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% my definitions
\newcommand{\requirement}{{\bf Requirement to the implementation.} }
\newcommand{\fig}[1]{Figure~\ref{fig:#1}}
\newcommand{\tab}[1]{Table~\ref{tab:#1}}
\newcommand{\Sec}[1]{Section~\ref{sec:#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}



\title*{Coarrays in the Context of XcalableMP}
% Use \titlerunning{Short Title} for an abbreviated version of
% your contribution title if the original one is too long

\author{H.\ Iwashita and M.\ Nakao}
% Use \authorrunning{Short Title} for an abbreviated version of
% your contribution title if the original one is too long

\institute{
Hidetoshi Iwashita 
\at Fujitsu Limited, 140 Miyamoto, Numazu-shi, Shizuoka 410-0396, Japan,
\email{iwashita.hideto@fujitsu.com}
\and
Masahiro Nakao \at RIKEN Center for Computational Science,
7-1-26 Minatojima-minami-machi, Chuo-ku, Kobe, Hyogo 650-0047, Japan,
\email{masahiro.nakao@riken.jp}
}

%
% Use the package "url.sty" to avoid
% problems with special characters
% used in your e-mail or web address
%
\maketitle

\abstract{
Coarray features has been implemented into the Omni XcalableMP compiler
with a source-to-source translator and layered runtime libraries.
%
Three memory allocation methods for coarrays were implemented for
communication libraries GASNet, MPI-3 and Fujitsu's native interface.
%
For the coarray PUT/GET communication, algorithms using DMA (zero-copy) 
and buffering were introduced. The important techniques for achieving 
high performance were the non-blocking PUT communication implemented 
in the runtime library and the optimization for the GET communication 
in the translator.
%
Using the ping-pong benchmark and the modified version, the fundamental
performance was evaluated and analyzed.
The MPI version of the Himeno benchmark is ported to coarray version
and modified for fully using the non-blocking PUT. 
As the result of the evaluation, non-blocking coarray version clearly 
outperformed the original and non-blocking MPI versions.
}

%\tableofcontents
%\clearpage

%
% Sections
%
\input{1.intro.tex} 

\input{2.lang.tex}

\input{3.implement.tex}

\input{4.eval.tex}

\input{5.related.tex}

\input{6.concl.tex}

\section*{Acknowledgments}
                                   
The present research used the computational resources of HA-PACS provided by the 
Interdisciplinary Computational Science Program at the Center for 
Computational Sciences at the University of Tsukuba. 

Part of the results is obtained by using the K computer at the RIKEN Advanced 
Institute for Computational Science. %(Proposal number ra000002). 


\begin{thebibliography}{99}
\addcontentsline{toc}{chapter}{\bibname}

\bibitem{xmp} 
XcalableMP Language Specification, \url{http://xcalablemp.org/specification.html}

\bibitem{coarray} 
John Reid, JKR Associates, UK. Coarrays in the next Fortran Standard.
ISO/IEC JTC1/SC22/WG5 N1824, April 21, 2010.

\bibitem{coarray18} ISO/IEC TS 18508:2015, Information technology -- 
Additional Parallel Features in Fortran, Technical Specification, December 1, 2015.

\bibitem{omni} 
Omni Compiler Project. http://omni-compiler.org

\bibitem{pgas15} 
Hidetoshi Iwashita, Masahiro Nakao, Mitsuhisa Sato. 2015. Preliminary Implementation 
of Coarray Fortran Translator Based on Omni XcalableMP. PGAS2015, Proceedings of 9th 
International Conference on PGAS Programming Models, pp.70-75, Washington, D.C., USA.
September, 2015.

\bibitem{EPCC} EPCC Fortran Coarray micro-benchmark suite.\\
https://www.epcc.ed.ac.uk/research/computing/performance-characterisation-and-benchmarking/epcc-co-array-fortran-micro

\bibitem{himeno} 
Himeno Benchmark. \url{http://accc.riken.jp/en/supercom/himenobmt/}

\bibitem{Rice} 
John Mellor-Crummey, Laksono Adhianto, William N. Scherer III, and Guohua Jin. 
PGAS’09, 3rd Conference on Partitioned Global Address Space Programming Models. 
Ashburn, VA. October, 2009.

\bibitem{HU}
Deepak Eachempati, Hyoung Joon Jun, and Barbara Chapman. 
An Open-Source Compiler and Runtime Implementation for Coarray Fortran. 
PGAS’10, 4th Conference on Partitioned Global Address Space Programming Models, 
No.13. 2010.

\bibitem{OpenCo} 
Alessandro Fanfarillo, Tobias Burnus, Valeria Cardellini, Salvatore Filippone, 
Dan Nagle, and Damian Rouson. OpenCoarrays: Open-source Transport Layers 
Supporting Coarray Fortran Compilers, PGAS'14, Proc. of 8th International 
Conference on Partitioned Global Address Space Programming Models, No. 4. 2014.


% \bibitem{mpi} 
% MPI: A Message-Passing Interface Standard, \url{http://mpi-forum.org} 

% \bibitem{fj-mpi}
% Naoyuki Shida, Shinji Sumimoto, and Atsuya Uno. 
% MPI Library and Low-Level Communication on the K computer, 
% FUJITSU Scientific \& Technical Journal, Vol.48, No.3, pp.324–330. 2012. 

% \bibitem{asia18}
% Hidetoshi Iwashita, Masahiro Nakao, Hitoshi Murai and Mitsuhisa Sato. 
% A Source-to-Source Translation of Coarray Fortran with MPI for High Performance, 
% HPC Asia 2018, Proceedings of the International Conference on High Performance 
% Computing in Asia-Pasific Region, pp.86-97, Tokyo, Japan. January, 2018.

\end{thebibliography}


% OpenCoarrays. http://www.opencoarrays.org

% XcalableMP Specification Working Group. 2014. XcalableMP Language Specification 
% Version 1.2.1. http://www.xcalablemp.org/specification.html

% David Henty. 2012. A Parallel Benchmark Suite for Fortran Coarrays. In 
% Applications, Tools and Techniques on the Road to Exascale Computing, Advances 
% in Parallel Computing, Vol.22, pp.281-288.


% [12]Cristian Coarfa. 2007. Portable High Performance and Scalability of Global 
% Address Space Languages. Ph.D. Thesis, Rice University (Jan. 2007).

%[15]Shiyao Ge, Deepak Eachempati, Dounia Khaldi, and Barbara Chapman. 2015. 
%An Evaluation of Anticipated Extensions for Fortran Coarrays, PGAS’15, 9th 
%International Conference on Partitioned Global Address Space Programming Models, 
%P47-58, Washington, D.C. USA (Sep. 2015).


\end{document}



